.PHONY: help dev prod stop clean logs test

help:
	@echo "Plural Chat Web Edition - Make Commands"
	@echo ""
	@echo "  make dev      - Start development environment"
	@echo "  make prod     - Start production environment"
	@echo "  make stop     - Stop all services"
	@echo "  make clean    - Stop and remove all containers, volumes"
	@echo "  make logs     - View logs from all services"
	@echo "  make test     - Run tests"
	@echo ""

dev:
	@echo "ğŸš€ Starting development environment..."
	docker-compose -f docker-compose.dev.yml up --build

prod:
	@echo "ğŸš€ Starting production environment..."
	@if [ ! -f backend/.env ]; then \
		echo "âš ï¸  Backend .env not found. Creating from example..."; \
		cp backend/.env.example backend/.env; \
		echo "ğŸ“ Please edit backend/.env with your configuration"; \
		exit 1; \
	fi
	docker-compose up --build -d
	@echo "âœ… Services started!"
	@echo "Frontend: http://localhost:3000"
	@echo "Backend: http://localhost:8000"
	@echo "API Docs: http://localhost:8000/docs"

stop:
	@echo "ğŸ›‘ Stopping all services..."
	docker-compose down
	docker-compose -f docker-compose.dev.yml down

clean:
	@echo "ğŸ§¹ Cleaning up..."
	docker-compose down -v
	docker-compose -f docker-compose.dev.yml down -v
	@echo "âœ… Cleanup complete!"

logs:
	@echo "ğŸ“‹ Viewing logs..."
	docker-compose logs -f

test:
	@echo "ğŸ§ª Running tests..."
	@echo "Backend tests:"
	cd backend && pytest
	@echo ""
	@echo "Frontend tests:"
	cd frontend && npm test
